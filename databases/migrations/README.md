# Partner System Database Migrations

파트너 시스템 데이터베이스 마이그레이션 파일 모음

## 📋 개요

이 디렉토리는 **멀티레벨 파트너십 관리 시스템**의 데이터베이스 구조를 정의하는 마이그레이션 파일들을 포함합니다. 파트너 등급 관리, 네트워크 조직 구축, 커미션 분배, 매출 추적 등의 복합적인 비즈니스 로직을 지원하는 테이블 구조를 제공합니다.

## 🗂️ 테이블 구조 및 관계도

```
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│  partner_tiers  │    │ partner_types   │    │ partner_users   │
│  (등급 관리)    │    │ (전문성 분류)   │    │ (파트너 정보)   │
│                 │    │                 │    │                 │
│ • 등급 정의     │    │ • 전문 분야     │    │ • 개인 정보     │
│ • 수수료율      │◄─┐  │ • 필수 스킬     │◄─┐  │ • 계층 관계     │
│ • 혜택/제한     │  │  │ • 타겟 성과     │  │  │ • 성과 추적     │
│ • 승급 조건     │  │  │ • 권한 설정     │  │  │ • 상태 관리     │
└─────────────────┘  │  └─────────────────┘  │  └─────────────────┘
                     │                       │            │
        ┌────────────┘           ┌───────────┘            │
        │                        │                        │
        ▼                        ▼                        ▼
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│partner_engineers│    │partner_applications│ │  partner_sales  │
│ (기술자 관리)   │    │ (지원서 관리)   │    │ (매출 관리)     │
│                 │    │                 │    │                 │
│ • 기술 역량     │    │ • 지원자 정보   │    │ • 매출 기록     │
│ • 작업 실적     │    │ • 승인 과정     │    │ • 커미션 기준   │
│ • 수익 관리     │    │ • 면접 관리     │    │ • 상태 추적     │
│ • 가용성        │    │ • 서류 관리     │    │ • 분류/채널     │
└─────────────────┘    └─────────────────┘    └─────────────────┘
                                                        │
                                                        ▼
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│partner_commissions│  │partner_network  │    │                 │
│ (커미션 관리)   │◄───┤  _relationships │    │                 │
│                 │    │ (관계 관리)     │    │                 │
│ • 다단계 분배   │    │                 │    │                 │
│ • 커미션 계산   │    │ • 조직 구조     │    │                 │
│ • 지급 처리     │    │ • 모집 관계     │    │                 │
│ • 세금/정산     │    │ • 성과 추적     │    │                 │
└─────────────────┘    └─────────────────┘    └─────────────────┘
```

## 📁 마이그레이션 파일 목록

### 🏆 핵심 시스템 테이블

| 파일명 | 테이블명 | 설명 | 우선순위 |
|--------|----------|------|----------|
| `2025_11_03_000001_create_partner_tiers_table.php` | `partner_tiers` | **등급 관리 시스템** - 파트너 등급 정의, 수수료율, 승급 조건, 계층 구조 | ⭐⭐⭐⭐⭐ |
| `2025_11_05_000001_create_partner_types_table.php` | `partner_types` | **전문성 분류** - 세일즈, 기술지원, 마케팅 등 파트너 타입 정의 | ⭐⭐⭐⭐⭐ |
| `2025_11_04_000003_create_partner_users_table.php` | `partner_users` | **파트너 회원 관리** - 개인정보, 계층관계, 네트워크, 성과 통합 관리 | ⭐⭐⭐⭐⭐ |

### 💼 업무 관리 테이블

| 파일명 | 테이블명 | 설명 | 우선순위 |
|--------|----------|------|----------|
| `2025_11_03_000002_create_partner_engineers_table.php` | `partner_engineers` | **엔지니어 실무 관리** - 기술역량, 작업실적, 수익관리 | ⭐⭐⭐⭐ |
| `2025_11_04_000004_create_partner_applications_table.php` | `partner_applications` | **지원서 처리** - 파트너 신청, 승인과정, 면접관리 | ⭐⭐⭐⭐ |

### 💰 수익 관리 테이블

| 파일명 | 테이블명 | 설명 | 우선순위 |
|--------|----------|------|----------|
| `2025_11_05_000004_create_partner_sales_table.php` | `partner_sales` | **매출 관리** - 매출 기록, 커미션 계산 기준, 상태 추적 | ⭐⭐⭐⭐⭐ |
| `2025_11_04_000007_create_partner_commissions_table.php` | `partner_commissions` | **커미션 분배** - 다단계 커미션 계산 및 지급 처리 | ⭐⭐⭐⭐⭐ |

### 🌐 조직 관리 테이블

| 파일명 | 테이블명 | 설명 | 우선순위 |
|--------|----------|------|----------|
| `2025_11_04_000008_create_partner_network_relationships_table.php` | `partner_network_relationships` | **네트워크 관계** - 조직구조, 모집관계, 성과추적 | ⭐⭐⭐⭐ |

## 🔄 실행 순서

마이그레이션은 다음 순서대로 실행되어야 합니다:

```bash
1. partner_tiers       # 등급 시스템 기반
2. partner_types       # 전문성 분류 기반
3. partner_users       # 파트너 정보 (tiers, types 참조)
4. partner_applications # 지원서 (users 참조)
5. partner_engineers   # 엔지니어 정보 (users, tiers 참조)
6. partner_sales       # 매출 정보 (users 참조)
7. partner_commissions # 커미션 (users, sales 참조)
8. partner_network_relationships # 관계 (users 참조)
```

## 🎯 주요 기능 영역

### 1. 등급 관리 시스템
- **Bronze → Silver → Gold → Platinum** 단계별 승급 시스템
- 등급별 차별화된 수수료율 및 혜택
- 성과 기반 자동 등급 평가
- 계층적 등급 구조 지원

### 2. 멀티레벨 네트워크
- 무제한 깊이의 조직 구조 지원
- 직접/간접 모집 관계 추적
- 관계별 성과 및 기여도 측정
- 실시간 조직도 및 계층 관리

### 3. 커미션 분배 시스템
- **6가지 커미션 타입** 지원
  - 직접 판매 커미션
  - 팀 보너스
  - 관리 보너스
  - 오버라이드 보너스
  - 모집 보너스
  - 등급 보너스
- 실시간 자동 계산 및 분배
- 세금 처리 및 실수령액 관리

### 4. 성과 관리 시스템
- 실시간 성과 지표 추적
- 매출/실적 기반 등급 승급
- 개인/팀 성과 분석
- KPI 대시보드 지원

## 🛠️ 기술적 특징

### 데이터 무결성
- **외래키 제약조건**으로 참조 무결성 보장
- **소프트 삭제**로 데이터 히스토리 보존
- **트랜잭션 처리**로 데이터 일관성 유지

### 성능 최적화
- **전략적 인덱싱**으로 쿼리 성능 향상
- **JSON 필드**를 통한 유연한 데이터 구조
- **캐싱 필드**로 빈번한 계산 작업 최적화

### 확장성
- **샤딩 지원** 필드로 대용량 데이터 처리
- **모듈형 구조**로 기능별 독립적 확장
- **JSON 설정**으로 동적 비즈니스 룰 적용

## 🔐 보안 고려사항

- **개인정보 보호**: 민감 정보는 JSON 필드에 암호화 저장
- **권한 관리**: 등급별 차별화된 데이터 접근 권한
- **감사 로그**: 모든 중요 데이터 변경 이력 추적
- **데이터 백업**: 소프트 삭제로 데이터 복구 가능성 보장

## 📊 모니터링 포인트

### 성능 모니터링
- 커미션 계산 처리 시간
- 대량 데이터 조회 성능
- 네트워크 관계 트리 조회 속도

### 비즈니스 모니터링
- 일일 커미션 지급 현황
- 등급별 파트너 분포
- 네트워크 성장률 추적

---

> ⚠️ **중요**: 이 시스템은 복잡한 비즈니스 로직을 포함하므로, 마이그레이션 실행 전 반드시 개발/스테이징 환경에서 충분한 테스트를 수행하시기 바랍니다.